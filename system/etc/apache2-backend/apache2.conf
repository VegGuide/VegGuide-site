<IfDefine !Testing>
    ServerRoot "/etc/apache2-backend"
    LockFile /var/lock/apache2-backend/accept.lock
    PidFile /var/run/apache2-backend.pid
</IfDefine>

<IfDefine Testing>
    ServerRoot "system/etc/apache2-backend"
    LockFile /home/autarch/.vegguide/var/lock/apache2-backend/accept.lock
    PidFile /home/autarch/.vegguide/var/run/apache2-backend.pid
</IfDefine>

Timeout 300

KeepAlive Off

MaxKeepAliveRequests 100

KeepAliveTimeout 15

<IfModule mpm_prefork_module>
    StartServers          12
    MinSpareServers       8
    MaxSpareServers       14
    MaxClients            20
    MaxRequestsPerChild   1000
</IfModule>

<IfDefine !Testing>
    User ${APACHE_RUN_USER}
    Group ${APACHE_RUN_GROUP}
</IfDefine>

AccessFileName .htaccess

<Files ~ "^\.ht">
    Order allow,deny
    Deny from all
</Files>

DefaultType text/plain

HostnameLookups Off

<IfDefine !Testing>
    ErrorLog /var/log/apache2-backend/error.log
</IfDefine>

<IfDefine Testing>
    ErrorLog /home/autarch/.vegguide/var/log/apache2-backend/error.log
</IfDefine>

LogLevel warn

<IfDefine !Testing>
    Include /etc/apache2-backend/mods-enabled/*.load
    Include /etc/apache2-backend/mods-enabled/*.conf
</IfDefine>

<IfDefine Testing>
    Include /etc/apache2/mods-enabled/*.load
    Include /etc/apache2/mods-enabled/*.conf
</IfDefine>

LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" combined
LogFormat "%h %l %u %t \"%r\" %>s %b" common
LogFormat "%{Referer}i -> %U" referer
LogFormat "%{User-agent}i" agent

ServerTokens Full

ServerSignature On

<IfDefine !Testing>
    Include /etc/apache2-backend/sites-enabled/
</IfDefine>

<IfDefine Testing>
    Include sites-available/
</IfDefine>
